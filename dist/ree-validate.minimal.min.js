!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).ReeValidate=t()}(this,function(){"use strict";var i=function(e){return g(["radio","checkbox"],e.type)},c=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return e.every(function(e){return null==e})},u=function(e,t,i){if(void 0===i&&(i=void 0),!e||!t)return i;var r=t;return e.split(".").every(function(e){return e in r?(r=r[e],!0):(r=i,!1)}),r},a=function(r){return r?f(r)?Object.keys(r).reduce(function(e,t){var i=[];return i=!0===r[t]?[]:Array.isArray(r[t])?r[t]:f(r[t])?r[t]:[r[t]],!1!==r[t]&&(e[t]=i),e},{}):"string"!=typeof r?(n("rules must be either a string or an object."),{}):r.split("|").reduce(function(e,t){var i,r,n,s=(r=[],n=(i=t).split(":")[0],g(i,":")&&(r=i.split(":").slice(1).join(":").split(",")),{name:n,params:r});return s.name&&(e[s.name]=s.params),e},{}):{}},n=function(e){console.warn("[ree-validate] "+e)},d=function(e){return new Error("[ree-validate] "+e)},f=function(e){return null!==e&&e&&"object"==typeof e&&!Array.isArray(e)},p=function(e){return"function"==typeof e},s=function(e,t){return e.classList?e.classList.contains(t):!!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},o=function(t,e,i){var r,n;if(t&&e){if(!Array.isArray(e))return i?(n=e,void((r=t).classList?r.classList.add(n):s(r,n)||(r.className+=" "+n))):void function(e,t){if(e.classList)e.classList.remove(t);else if(s(e,t)){var i=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(i," ")}}(t,e);e.forEach(function(e){return o(t,e,i)})}},h=function(e){if(p(Array.from))return Array.from(e);for(var t=[],i=e.length,r=0;r<i;r++)t.push(e[r]);return t},l=function(e){for(var t=[],i=arguments.length-1;0<i--;)t[i]=arguments[i+1];if(p(Object.assign))return Object.assign.apply(Object,[e].concat(t));if(null==e)throw new TypeError("Cannot convert undefined or null to object");var r=Object(e);return t.forEach(function(t){null!=t&&Object.keys(t).forEach(function(e){r[e]=t[e]})}),r},t=0,r="{id}",v=function(e,t){var i=Array.isArray(e)?e:h(e),r=function(e,t){for(var i=Array.isArray(e)?e:h(e),r=0;r<i.length;r++)if(t(i[r]))return r;return-1}(i,t);return-1===r?void 0:i[r]},m=function(r,n){return f(r)&&f(n)&&Object.keys(n).forEach(function(e){var t,i;if(f(n[e]))return r[e]||l(r,((t={})[e]={},t)),void m(r[e],n[e]);l(r,((i={})[e]=n[e],i))}),r},g=function(e,t){return-1!==e.indexOf(t)},y="en",e=function(e){void 0===e&&(e={}),this.container={},this.merge(e)},b={locale:{configurable:!0}};b.locale.get=function(){return y},b.locale.set=function(e){y=e||"en"},e.prototype.hasLocale=function(e){return!!this.container[e]},e.prototype.setDateFormat=function(e,t){this.container[e]||(this.container[e]={}),this.container[e].dateFormat=t},e.prototype.getDateFormat=function(e){return this.container[e]&&this.container[e].dateFormat?this.container[e].dateFormat:null},e.prototype.getMessage=function(e,t,i){var r=null;return r=this.hasMessage(e,t)?this.container[e].messages[t]:this._getDefaultMessage(e),p(r)?r.apply(void 0,i):r},e.prototype.getFieldMessage=function(e,t,i,r){if(!this.hasLocale(e))return this.getMessage(e,i,r);var n=this.container[e].custom&&this.container[e].custom[t];if(!n||!n[i])return this.getMessage(e,i,r);var s=n[i];return p(s)?s.apply(void 0,r):s},e.prototype._getDefaultMessage=function(e){return this.hasMessage(e,"_default")?this.container[e].messages._default:this.container.en.messages._default},e.prototype.getAttribute=function(e,t,i){return void 0===i&&(i=""),this.hasAttribute(e,t)?this.container[e].attributes[t]:i},e.prototype.hasMessage=function(e,t){return!!(this.hasLocale(e)&&this.container[e].messages&&this.container[e].messages[t])},e.prototype.hasAttribute=function(e,t){return!!(this.hasLocale(e)&&this.container[e].attributes&&this.container[e].attributes[t])},e.prototype.merge=function(e){m(this.container,e)},e.prototype.setMessage=function(e,t,i){this.hasLocale(e)||(this.container[e]={messages:{},attributes:{}}),this.container[e].messages[t]=i},e.prototype.setAttribute=function(e,t,i){this.hasLocale(e)||(this.container[e]={messages:{},attributes:{}}),this.container[e].attributes[t]=i},Object.defineProperties(e.prototype,b);var _={default:new e({en:{messages:{},attributes:{},custom:{}}})},F="default",A=function(){};A._checkDriverName=function(e){if(!e)throw d("you must provide a name to the dictionary driver")},A.setDriver=function(e,t){void 0===t&&(t=null),this._checkDriverName(e),t&&(_[e]=t),F=e},A.getDriver=function(){return _[F]};var j=function e(t){void 0===t&&(t=null),this.items=t&&t instanceof e?t.items:[]};j.prototype["function"==typeof Symbol?Symbol.iterator:"@@iterator"]=function(){var e=this,t=0;return{next:function(){return{value:e.items[t++],done:t>e.items.length}}}},j.prototype.add=function(e){var t;(t=this.items).push.apply(t,this._normalizeError(e))},j.prototype._normalizeError=function(e){return Array.isArray(e)?e.map(function(e){return e.scope=c(e.scope)?null:e.scope,e}):(e.scope=c(e.scope)?null:e.scope,[e])},j.prototype.regenerate=function(){this.items.forEach(function(e){e.msg=p(e.regenerate)?e.regenerate():e.msg})},j.prototype.update=function(t,e){var i=v(this.items,function(e){return e.id===t});if(i){var r=this.items.indexOf(i);this.items.splice(r,1),i.scope=e.scope,this.items.push(i)}},j.prototype.all=function(i){return this.items.filter(function(e){var t=!0;return c(i)||(t=e.scope===i),t}).map(function(e){return e.msg})},j.prototype.any=function(i){return!!this.items.filter(function(e){var t=!0;return c(i)||(t=e.scope===i),t}).length},j.prototype.clear=function(e){c(e)&&(e=null);for(var t=0;t<this.items.length;++t)this.items[t].scope===e&&(this.items.splice(t,1),--t)},j.prototype.collect=function(e,t,r){void 0===r&&(r=!0);var n=!c(e)&&!e.includes("*"),i=function(e){var t,i=e.reduce(function(e,t){return e[t.field]||(e[t.field]=[]),e[t.field].push(r?t.msg:t),e},{});return n?(t=i,p(Object.values)?Object.values(t):t[Object.keys(t)[0]])[0]||[]:i};if(c(e))return i(this.items);var s=c(t)?String(e):t+"."+e,a=this._makeCandidateFilters(s),o=a.isPrimary,u=a.isAlt,l=this.items.reduce(function(e,t){return o(t)&&e.primary.push(t),u(t)&&e.alt.push(t),e},{primary:[],alt:[]});return i(l=l.primary.length?l.primary:l.alt)},j.prototype.count=function(){return this.items.length},j.prototype.firstById=function(t){var e=v(this.items,function(e){return e.id===t});return e?e.msg:void 0},j.prototype.first=function(e,t){void 0===t&&(t=null);var i=c(t)?e:t+"."+e,r=this._match(i);return r&&r.msg},j.prototype.firstRule=function(e,t){var i=this.collect(e,t,!1);return i.length&&i[0].rule||void 0},j.prototype.has=function(e,t){return void 0===t&&(t=null),!!this.first(e,t)},j.prototype.firstByRule=function(e,t,i){void 0===i&&(i=null);var r=this.collect(e,i,!1).filter(function(e){return e.rule===t})[0];return r&&r.msg||void 0},j.prototype.firstNot=function(e,t,i){void 0===t&&(t="required"),void 0===i&&(i=null);var r=this.collect(e,i,!1).filter(function(e){return e.rule!==t})[0];return r&&r.msg||void 0},j.prototype.removeById=function(t){var e=function(e){return e.id===t};Array.isArray(t)&&(e=function(e){return-1!==t.indexOf(e.id)});for(var i=0;i<this.items.length;++i)e(this.items[i])&&(this.items.splice(i,1),--i)},j.prototype.remove=function(e,t){if(!c(e))for(var i=c(t)?String(e):t+"."+e,r=this._makeCandidateFilters(i),n=r.isPrimary,s=r.isAlt,a=function(e){return n(t=e)||s(t);var t},o=0;o<this.items.length;++o)a(this.items[o])&&(this.items.splice(o,1),--o)},j.prototype._makeCandidateFilters=function(e){var t=function(){return!0},i=function(){return!0},r=function(){return!0},n=function(e){var t=null;if(g(e,":")&&(t=e.split(":").pop(),e=e.replace(":"+t,"")),"#"===e[0])return{id:e.slice(1),rule:t,name:null,scope:null};var i=null,r=e;if(g(e,".")){var n=e.split(".");i=n[0],r=n.slice(1).join(".")}return{id:null,scope:i,name:r,rule:t}}(e),s=n.id,a=n.rule,o=n.scope,u=n.name;if(a&&(t=function(e){return e.rule===a}),s)return{isPrimary:function(e){return t(e)&&function(e){return s===e.id}},isAlt:function(){return!1}};i=c(o)?function(e){return c(e.scope)}:function(e){return e.scope===o},c(u)||"*"===u||(r=function(e){return e.field===u});return{isPrimary:function(e){return r(e)&&t(e)&&i(e)},isAlt:function(e){return t(e)&&e.field===o+"."+u}}},j.prototype._match=function(e){if(!c(e)){var t=this._makeCandidateFilters(e),s=t.isPrimary,a=t.isAlt;return this.items.reduce(function(e,t,i,r){var n=i===r.length-1;return e.primary?n?e.primary:e:(s(t)&&(e.primary=t),a(t)&&(e.alt=t),n?e.primary||e.alt:e)},{})}};var O={},D=function(){},E={rules:{configurable:!0}};D.add=function(e,t){var i=t.validate,r=t.options,n=t.paramNames;O[e]={validate:i,options:r,paramNames:n}},E.rules.get=function(){return O},D.has=function(e){return!!O[e]},D.isImmediate=function(e){return!(!O[e]||!O[e].options.immediate)},D.isRequireRule=function(e){return!(!O[e]||!O[e].options.computesRequired)},D.isTargetRule=function(e){return!(!O[e]||!O[e].options.hasTarget)},D.remove=function(e){delete O[e]},D.getParamNames=function(e){return O[e]&&O[e].paramNames},D.getOptions=function(e){return O[e]&&O[e].options},D.getValidatorMethod=function(e){return O[e]?O[e].validate:null},Object.defineProperties(D,E);var N=function(e,t,i){e.addEventListener(t,i,{passive:!0})},k={targetOf:null,immediate:!1,scope:null,listen:!0,name:null,rules:{},classes:!1,validity:!0,events:"change|blur",delay:0,classNames:{touched:"touched",untouched:"untouched",valid:"valid",invalid:"invalid",pristine:"pristine",dirty:"dirty"}},P=function(e){void 0===e&&(e={}),this.id=(9999<=t&&(t=0,r=r.replace("{id}","_{id}")),t++,r.replace("{id}",String(t))),this.updated=!1,this.dependencies=[],this.events=[],this.delay=0,this.rules={},this.forceRequired=!1,this.classNames=l({},k.classNames),e=l({},k,e),this._delay=c(e.delay)?0:e.delay,this.validity=e.validity,this.flags={untouched:!0,touched:!1,dirty:!1,pristine:!0,valid:null,invalid:null,validated:!1,pending:!1,required:!1,changed:!1},this.update(e),this.initialValue=this.value,this.updated=!1},x={validator:{configurable:!0},isRequired:{configurable:!0},isDisabled:{configurable:!0},alias:{configurable:!0},value:{configurable:!0},bails:{configurable:!0},rejectsFalse:{configurable:!0}};x.validator.get=function(){return{validate:function(){}}},x.isRequired.get=function(){return!!this.rules.required},x.isDisabled.get=function(){return!1},x.alias.get=function(){return this._alias},x.value.get=function(){if(p(this.getter))return this.getter()},x.bails.get=function(){return this._bails},x.rejectsFalse.get=function(){return!1},P.prototype.matches=function(e){return!e||(e.id?this.id===e.id:void 0===e.name&&void 0===e.scope||(void 0===e.scope?this.name===e.name:void 0===e.name?this.scope===e.scope:e.name===this.name&&e.scope===this.scope))},P.prototype.waitFor=function(e){this._waitingFor=e},P.prototype.isWaitingFor=function(e){return this._waitingFor===e},P.prototype.update=function(e){var t,i,r,n;this.targetOf=e.targetOf||null,this.immediate=e.immediate||this.immediate||!1,this.persist=e.persist||this.persist||!1,!c(e.scope)&&e.scope!==this.scope&&p(this.validator.update)&&this.validator.update(this.id,{scope:e.scope}),this.scope=c(e.scope)?c(this.scope)?null:this.scope:e.scope,this.name=(c(e.name)?e.name:String(e.name))||this.name||null,this.rules=void 0!==e.rules?a(e.rules):this.rules,this._bails=void 0!==e.bails?e.bails:this._bails,this.listen=void 0!==e.listen?e.listen:this.listen,this.classes=!(!e.classes&&!this.classes)&&!this.componentInstance,this.classNames=f(e.classNames)?m(this.classNames,e.classNames):this.classNames,this.getter=p(e.getter)?e.getter:this.getter,this._alias=e.alias||this._alias,this.events=e.events?(t=e.events)?"string"==typeof t?t.split("|"):t:[]:this.events,this.delay=(i=this.events,r=e.delay||this.delay,n=this._delay,"number"==typeof r?i.reduce(function(e,t){return e[t]=r,e},{}):i.reduce(function(e,t){return e[t]="object"==typeof r&&t in r?r[t]:"number"==typeof n?n:n&&n[t]||0,e},{})),this.updateDependencies(),this.addActionListeners(),void 0!==e.rules&&(this.flags.required=this.isRequired),this.flags.validated&&void 0!==e.rules&&this.updated&&this.validator.validate("#"+this.id),this.updated=!0,this.updateClasses()},P.prototype.reset=function(){var t=this;this._cancellationToken&&(this._cancellationToken.cancelled=!0,delete this._cancellationToken);var i={untouched:!0,touched:!1,dirty:!1,pristine:!0,valid:null,invalid:null,validated:!1,pending:!1,required:!1,changed:!1};Object.keys(this.flags).filter(function(e){return"required"!==e}).forEach(function(e){t.flags[e]=i[e]}),this.addActionListeners(),this.updateClasses()},P.prototype.setFlags=function(t){var i=this,r={pristine:"dirty",dirty:"pristine",valid:"invalid",invalid:"valid",touched:"untouched",untouched:"touched"};Object.keys(t).forEach(function(e){i.flags[e]=t[e],r[e]&&void 0===t[r[e]]&&(i.flags[r[e]]=!t[e])}),void 0===t.untouched&&void 0===t.touched&&void 0===t.dirty&&void 0===t.pristine||this.addActionListeners(),this.updateClasses()},P.prototype.updateDependencies=function(){var r=this;this.dependencies.forEach(function(e){return e.field.destroy()}),this.dependencies=[];var e=Object.keys(this.rules).reduce(function(e,t){return D.isTargetRule(t)&&e.push({selector:r.rules[t][0],name:t}),e},[]);e.length&&e.forEach(function(e){e.selector;var t=e.name,i={classes:r.classes,classNames:r.classNames,delay:r.delay,scope:r.scope,events:r.events.join("|"),immediate:r.immediate,targetOf:r.id};r.dependencies.push({name:t,field:new P(i)})})},P.prototype.updateClasses=function(){var e=this;if(this.classes&&!this.isDisabled){var t;i(this.el)||(t=this.el,o(t,e.classNames.dirty,e.flags.dirty),o(t,e.classNames.pristine,e.flags.pristine),o(t,e.classNames.touched,e.flags.touched),o(t,e.classNames.untouched,e.flags.untouched),!c(e.flags.valid)&&e.flags.validated&&o(t,e.classNames.valid,e.flags.valid),!c(e.flags.invalid)&&e.flags.validated&&o(t,e.classNames.invalid,e.flags.invalid))}},P.prototype.addActionListeners=function(){var e=this;if(this.el){if(this.el){N(this.el,"change",function(){e.flags.dirty=!0,e.flags.pristine=!1,e.classes&&(o(e.el,e.classNames.pristine,!1),o(e.el,e.classNames.dirty,!0))});var t=i(this.el)?"change":"blur";N(this.el,t,function(){e.flags.touched=!0,e.flags.untouched=!1,e.classes&&(o(e.el,e.classNames.touched,!0),o(e.el,e.classNames.untouched,!1))})}}},P.prototype.checkValueChanged=function(){return(null!==this.initialValue||""!==this.value||(e=this.el,!g(["text","password","search","email","tel","url","textarea","number"],e.type)))&&this.value!==this.initialValue;var e},P.prototype._determineInputEvent=function(){return"change"},P.prototype._determineEventList=function(t){return this.events.length?this.events.map(function(e){return"input"===e?t:e}):[].concat(this.events).map(function(e){return"input"===e?"change":e})},P.prototype.destroy=function(){this._cancellationToken&&(this._cancellationToken.cancelled=!0),this.dependencies.forEach(function(e){return e.field.destroy()}),this.dependencies=[]},Object.defineProperties(P.prototype,x);var R=function(e){void 0===e&&(e=[]),this.items=e||[]},w={length:{configurable:!0}};R.prototype["function"==typeof Symbol?Symbol.iterator:"@@iterator"]=function(){var e=this,t=0;return{next:function(){return{value:e.items[t++],done:t>e.items.length}}}},w.length.get=function(){return this.items.length},R.prototype.find=function(t){return v(this.items,function(e){return e.matches(t)})},R.prototype.filter=function(i){return Array.isArray(i)?this.items.filter(function(t){return i.some(function(e){return t.matches(e)})}):this.items.filter(function(e){return e.matches(i)})},R.prototype.map=function(e){return this.items.map(e)},R.prototype.remove=function(e){var t=null;if(!(t=e instanceof P?e:this.find(e)))return null;var i=this.items.indexOf(t);return this.items.splice(i,1),t},R.prototype.push=function(e){if(!(e instanceof P))throw d("FieldBag only accepts instances of Field that has an id defined.");if(!e.id)throw d("Field id must be defined.");if(this.find({id:e.id}))throw d("Field with id "+e.id+" is already added.");this.items.push(e)},Object.defineProperties(R.prototype,w);var M=function(e,t){void 0===t&&(t={fastExit:!0}),this.errors=new j,this.fields=new R,this._createFields(e),this.paused=!1,this.fastExit=!!c(t&&t.fastExit)||t.fastExit},T={dictionary:{configurable:!0},flags:{configurable:!0},locale:{configurable:!0}},q={dictionary:{configurable:!0},locale:{configurable:!0}};q.dictionary.get=function(){return A.getDriver()},T.dictionary.get=function(){return A.getDriver()},T.flags.get=function(){return this.fields.items.reduce(function(e,t){var i;return t.scope?e["$"+t.scope]=((i={})[t.name]=t.flags,i):e[t.name]=t.flags,e},{})},T.locale.get=function(){return M.locale},T.locale.set=function(e){M.locale=e},q.locale.get=function(){return A.getDriver().locale},q.locale.set=function(e){A.getDriver().locale=e},M.extend=function(e,t,i){void 0===i&&(i={}),M._guardExtend(e,t),M._merge(e,{validator:t,paramNames:i&&i.paramNames,options:l({},{hasTarget:!1,immediate:!0},i||{})})},M.isTargetRule=function(e){return D.isTargetRule(e)},M.prototype.localize=function(e,t){M.localize(e,t)},M.localize=function(e,t){var i;if(f(e))A.getDriver().merge(e);else{if(t){var r=e||t.name;t=l({},t),A.getDriver().merge(((i={})[r]=t,i))}e&&(M.locale=e)}},M.prototype.attach=function(e){var t={name:e.name,scope:e.scope,persist:!0},i=e.persist?this.fields.find(t):null;i&&(e.flags=i.flags,i.destroy(),this.fields.remove(i));var r=e.initialValue,n=new P(e);return this.fields.push(n),n.immediate?this.validate("#"+n.id,r||n.value):this._validate(n,r||n.value,{initial:!0}).then(function(e){n.flags.valid=e.valid,n.flags.invalid=!e.valid}),n},M.prototype.flag=function(e,t,i){void 0===i&&(i=null);var r=this._resolveField(e,void 0,i);r&&t&&r.setFlags(t)},M.prototype.detach=function(e,t,i){var r=p(e.destroy)?e:this._resolveField(e,t,i);r&&(r.persist||(r.destroy(),this.errors.remove(r.name,r.scope,r.vmId),this.fields.remove(r)))},M.prototype.extend=function(e,t,i){void 0===i&&(i={}),M.extend(e,t,i)},M.prototype.reset=function(e){var t=this;this.fields.filter(e).forEach(function(e){e.waitFor(null),e.reset(),t.errors.remove(e.name,e.scope)})},M.prototype.update=function(e,t){var i=t.scope;this._resolveField("#"+e)&&this.errors.update(e,{scope:i})},M.prototype.validate=function(e,t,i){var r=this;void 0===i&&(i={});var n=i.silent,s=i.scope;if(this.paused)return Promise.resolve(!0);if(c(e))return this.validateScopes({silent:n,scope:s});if("*"===e)return this.validateAll(void 0,{silent:n});if(/^(.+)\.\*$/.test(e)){var a=e.match(/^(.+)\.\*$/)[1];return this.validateAll(a)}var o=this._resolveField(e);if(!o)return this._handleFieldNotFound("unknown");n||(o.flags.pending=!0),void 0===t&&(t=o.value);var u=this._validate(o,t);return o.waitFor(u),u.then(function(e){return!n&&o.isWaitingFor(u)&&(o.waitFor(null),r._handleValidationResults([e],s)),e.valid})},M.prototype.pause=function(){return this.paused=!0,this},M.prototype.resume=function(){return this.paused=!1,this},M.prototype.validateAll=function(t,e){var i=this;void 0===e&&(e={});var r=e.silent,n=e.scope;if(this.paused)return Promise.resolve(!0);var s=null,a=!1;return"string"==typeof t?s={scope:t}:f(t)?(s=Object.keys(t).map(function(e){return{name:e,scope:n}}),a=!0):s=Array.isArray(t)?t.map(function(e){return{name:e,scope:n}}):{scope:null},Promise.all(this.fields.filter(s).map(function(e){return i._validate(e,a?t[e.name]:e.value)})).then(function(e){return r||i._handleValidationResults(e),e.every(function(e){return e.valid})})},M.prototype.validateScopes=function(e){var t=this;void 0===e&&(e={});var i=e.silent,r=e.scope;return this.paused?Promise.resolve(!0):Promise.all(this.fields.filter({scope:r}).map(function(e){return t._validate(e,e.value)})).then(function(e){return i||t._handleValidationResults(e,r),e.every(function(e){return e.valid})})},M.prototype.verify=function(e,t,n){void 0===n&&(n={});var s={name:n&&n.name||"{field}",rules:a(t),bails:u("bails",n,!0)};s.isRequired=s.rules.required;var i=Object.keys(s.rules).filter(M.isTargetRule);return i.length&&n&&f(n.values)&&i.forEach(function(e){var t=s.rules[e],i=t[0],r=t.slice(1);s.rules[e]=[n.values[i]].concat(r)}),this._validate(s,e).then(function(e){return{valid:e.valid,errors:e.errors.map(function(e){return e.msg})}})},M.prototype.destroy=function(){},M.prototype._createFields=function(i){var r=this;i&&Object.keys(i).forEach(function(e){var t=l({},{name:e,rules:i[e]});r.attach(t)})},M.prototype._getDateFormat=function(e){var t=null;return e.date_format&&Array.isArray(e.date_format)&&(t=e.date_format[0]),t||A.getDriver().getDateFormat(this.locale)},M.prototype._formatErrorMessage=function(e,t,i,r){void 0===i&&(i={}),void 0===r&&(r=null);var n=this._getFieldDisplayName(e),s=this._getLocalizedParams(t,r);return A.getDriver().getFieldMessage(this.locale,e.name,t.name,[n,s,i])},M.prototype._convertParamObjectToArray=function(i,e){if(Array.isArray(i))return i;var t=D.getParamNames(e);return t&&f(i)?t.reduce(function(e,t){return t in i&&e.push(i[t]),e},[]):i},M.prototype._getLocalizedParams=function(e,t){void 0===t&&(t=null);var i=this._convertParamObjectToArray(e.params,e.name);return e.options.hasTarget&&i&&i[0]?[t||A.getDriver().getAttribute(this.locale,i[0],i[0])].concat(i.slice(1)):i},M.prototype._getFieldDisplayName=function(e){return e.alias||A.getDriver().getAttribute(this.locale,e.name,e.name)},M.prototype._convertParamArrayToObj=function(t,e){var r=D.getParamNames(e);if(!r)return t;if(f(t)){if(r.some(function(e){return-1!==Object.keys(t).indexOf(e)}))return t;t=[t]}return t.reduce(function(e,t,i){return e[r[i]]=t,e},{})},M.prototype._test=function(r,e,n){var s=this,t=D.getValidatorMethod(n.name),i=Array.isArray(n.params)?h(n.params):n.params;i||(i=[]);var a=null;if(!t||"function"!=typeof t)return Promise.reject(d("No such validator '"+n.name+"' exists."));if(n.options.hasTarget&&r.dependencies){var o=v(r.dependencies,function(e){return e.name===n.name});o&&(a=o.field.alias,i=[o.field.value].concat(i.slice(1)))}else"required"===n.name&&r.rejectsFalse&&(i=i.length?i:[!0]);if(n.options.isDate){var u=this._getDateFormat(r.rules);"date_format"!==n.name&&i.push(u)}var l=t(e,this._convertParamArrayToObj(i,n.name));return p(l.then)?l.then(function(e){var t=!0,i={};return Array.isArray(e)?t=e.every(function(e){return f(e)?e.valid:e}):(t=f(e)?e.valid:e,i=e.data),{valid:t,errors:t?[]:[s._createFieldError(r,n,i,a)]}}):(f(l)||(l={valid:l,data:{}}),{valid:l.valid,errors:l.valid?[]:[this._createFieldError(r,n,l.data,a)]})},M._merge=function(e,t){var i=t.validator,r=t.options,n=t.paramNames,s=p(i)?i:i.validate;i.getMessage&&A.getDriver().setMessage(M.locale,e,i.getMessage),D.add(e,{validate:s,options:r,paramNames:n})},M._guardExtend=function(e,t){if(!p(t)&&!p(t.validate))throw d("Extension Error: The validator '"+e+"' must be a function or have a 'validate' method.")},M.prototype._createFieldError=function(e,t,i,r){var n=this;return{id:e.id,field:e.name,msg:this._formatErrorMessage(e,t,i,r),rule:t.name,scope:e.scope,regenerate:function(){return n._formatErrorMessage(e,t,i,r)}}},M.prototype._resolveField=function(e,t,i){if("#"===e[0])return this.fields.find({id:e.slice(1)});if(!c(t))return this.fields.find({name:e,scope:t});if(g(e,".")){var r=e.split("."),n=r[0],s=r.slice(1),a=this.fields.find({name:s.join("."),scope:n});if(a)return a}return this.fields.find({name:e,scope:null,vmId:i})},M.prototype._handleFieldNotFound=function(e,t){var i=c(t)?e:(c(t)?"":t+".")+e;return Promise.reject(d('Validating a non-existent field: "'+i+'". Use "attach()" first.'))},M.prototype._handleValidationResults=function(i){var t=this,e=i.map(function(e){return{id:e.id}});this.errors.removeById(e.map(function(e){return e.id})),i.forEach(function(e){t.errors.remove(e.field,e.scope)});var r=i.reduce(function(e,t){return e.push.apply(e,t.errors),e},[]);this.errors.add(r),this.fields.filter(e).forEach(function(t){var e=v(i,function(e){return e.id===t.id});t.setFlags({pending:!1,valid:e.valid,validated:!0})})},M.prototype._shouldSkip=function(e,t){return!1!==e.bails&&(!!e.isDisabled||!e.isRequired&&(c(t)||""===t||(i=t,Array.isArray(i)&&0===i.length)));var i},M.prototype._shouldBail=function(e){return void 0!==e.bails?e.bails:this.fastExit},M.prototype._validate=function(r,n,e){var s=this;void 0===e&&(e={});var t=e.initial,i=Object.keys(r.rules).filter(D.isRequireRule);if(r.forceRequired=!1,i.forEach(function(e){var t=D.getOptions(e),i=s._test(r,n,{name:e,params:r.rules[e],options:t});if(p(i.then))throw d("Require rules cannot be async");if(!f(i))throw d("Require rules has to return an object (see docs)");!0===i.data.required&&(r.forceRequired=!0)}),this._shouldSkip(r,n))return Promise.resolve({valid:!0,id:r.id,field:r.name,scope:r.scope,errors:[]});var a=[],o=[],u=!1;return p(r.checkValueChanged)&&(r.flags.changed=r.checkValueChanged()),Object.keys(r.rules).filter(function(e){return!t||!D.has(e)||D.isImmediate(e)}).some(function(e){var t=D.getOptions(e),i=s._test(r,n,{name:e,params:r.rules[e],options:t});return p(i.then)?a.push(i):!i.valid&&s._shouldBail(r)?(o.push.apply(o,i.errors),u=!0):a.push(new Promise(function(e){return e(i)})),u}),u?Promise.resolve({valid:!1,errors:o,id:r.id,field:r.name,scope:r.scope}):Promise.all(a).then(function(e){return e.reduce(function(e,t){var i;return t.valid||(i=e.errors).push.apply(i,t.errors),e.valid=e.valid&&t.valid,e},{valid:!0,errors:o,id:r.id,field:r.name,scope:r.scope})})},Object.defineProperties(M.prototype,T),Object.defineProperties(M,q);var L=function(i){return f(i)?Object.keys(i).reduce(function(e,t){return e[t]=L(i[t]),e},{}):p(i)?i("{0}",["{1}","{2}","{3}"]):i},V=function(e,t){this.i18n=e,this.rootKey=t},C={locale:{configurable:!0}};C.locale.get=function(){return this.i18n.locale},C.locale.set=function(e){n("Cannot set locale from the validator when using vue-i18n, use i18n.locale setter instead")},V.prototype.getDateFormat=function(e){return this.i18n.getDateTimeFormat(e||this.locale)},V.prototype.setDateFormat=function(e,t){this.i18n.setDateTimeFormat(e||this.locale,t)},V.prototype.getMessage=function(e,t,i){var r=this.rootKey+".messages."+t,n=this.i18n.t(r,i);return n!==r?n:this.i18n.t(this.rootKey+".messages._default",i)},V.prototype.getAttribute=function(e,t,i){void 0===i&&(i="");var r=this.rootKey+".attributes."+t,n=this.i18n.t(r);return n!==r?n:i},V.prototype.getFieldMessage=function(e,t,i,r){var n=this.rootKey+".custom."+t+"."+i,s=this.i18n.t(n,r);return s!==n?s:this.getMessage(e,i,r)},V.prototype.merge=function(a){var o=this;Object.keys(a).forEach(function(e){var t,i,r,n=m({},u(e+"."+o.rootKey,o.i18n.messages,{})),s=m(n,(i=a[e],r={},i.messages&&(r.messages=L(i.messages)),i.custom&&(r.custom=L(i.custom)),i.attributes&&(r.attributes=i.attributes),c(i.dateFormat)||(r.dateFormat=i.dateFormat),r));o.i18n.mergeLocaleMessage(e,((t={})[o.rootKey]=s,t)),s.dateFormat&&o.i18n.setDateTimeFormat(e,s.dateFormat)})},V.prototype.setMessage=function(e,t,i){var r,n;this.merge(((n={})[e]={messages:(r={},r[t]=i,r)},n))},V.prototype.setAttribute=function(e,t,i){var r,n;this.merge(((n={})[e]={attributes:(r={},r[t]=i,r)},n))},Object.defineProperties(V.prototype,C);var I=l({},{locale:"en",delay:0,errorBagName:"errors",dictionary:null,fieldsBagName:"fields",classes:!1,classNames:null,events:"input",inject:!0,fastExit:!0,aria:!0,validity:!1,useConstraintAttrs:!0,i18n:null,i18nRootKey:"validation"}),S=function(){return I},$=function(e){this.configure(e),this._validator=new M(null,{fastExit:e&&e.fastExit}),this._initI18n(this.config)},B={i18nDriver:{configurable:!0},config:{configurable:!0}},K={i18nDriver:{configurable:!0},config:{configurable:!0}};$.setI18nDriver=function(e,t){A.setDriver(e,t)},$.configure=function(e){I=l({},I,e)},$.use=function(e,t){if(void 0===t&&(t={}),!p(e))return n("The plugin must be a callable function");e({Validator:M,ErrorBag:j,Rules:M.rules},t)},B.i18nDriver.get=function(){return A.getDriver()},K.i18nDriver.get=function(){return A.getDriver()},B.config.get=function(){return S()},K.config.get=function(){return S()},$.prototype._initI18n=function(e){var t=e.dictionary,i=e.i18n,r=e.i18nRootKey,n=e.locale;i&&$.setI18nDriver("i18n",new V(i,r)),t&&this.i18nDriver.merge(t),n&&!i&&this._validator.localize(n)},$.prototype.configure=function(e){$.configure(e)},Object.defineProperties($.prototype,B),Object.defineProperties($,K),$.Validator=M,$.ErrorBag=j;var z=function(i,r){var n={pristine:function(e,t){return e&&t},dirty:function(e,t){return e||t},touched:function(e,t){return e||t},untouched:function(e,t){return e&&t},valid:function(e,t){return e&&t},invalid:function(e,t){return e||t},pending:function(e,t){return e||t},required:function(e,t){return e||t},validated:function(e,t){return e&&t}};return Object.keys(n).reduce(function(e,t){return e[t]=n[t](i[t],r[t]),e},{})},W=function(r,n){return void 0===n&&(n=!0),Object.keys(r).reduce(function(e,t){if(!e)return e=l({},r[t]);var i=0===t.indexOf("$");return n&&i?z(W(r[t]),e):!n&&i?e:e=z(e,r[t])},null)};return $.version="3.3.0",$.mapFields=function(e){if(!e)return function(){return W(this.$validator.flags)};var t,s=(t=e,Array.isArray(t)?t.reduce(function(e,t){return g(t,".")?e[t.split(".")[1]]=t:e[t]=t,e},{}):t);return Object.keys(s).reduce(function(e,r){var n=s[r];return e[r]=function(){if(this.$validator.flags[n])return this.$validator.flags[n];if("*"===s[r])return W(this.$validator.flags,!1);if(n.indexOf(".")<=0)return{};var e=n.split("."),t=e[0],i=e.slice(1);return t=this.$validator.flags["$"+t],"*"===(i=i.join("."))&&t?W(t):t&&t[i]?t[i]:{}},e},{})},$});